(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{433:function(n,e,t){"use strict";t.r(e);var a=t(31),i=Object(a.a)({},(function(){var n=this,e=n.$createElement,t=n._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":n.$parent.slotKey}},[t("h1",{attrs:{id:"性能优化篇"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能优化篇"}},[n._v("#")]),n._v(" 性能优化篇")]),n._v(" "),t("h1",{attrs:{id:"性能优化篇-2"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#性能优化篇-2"}},[n._v("#")]),n._v(" 性能优化篇")]),n._v(" "),t("p",[n._v("function Node(value, next) {\nthis.value = value;\nthis.next = next;\n}")]),n._v(" "),t("p",[n._v("function Cache(initialCapacity, initialValue) {\nthis.size = 0\nthis._keymap = {}\nthis.head = null;\nthis.tail = null;\nthis.capacity = initialCapacity;")]),n._v(" "),t("p",[n._v("if (initialValue) {\nvar key = Object.keys(initialValue)[0];\n//Object.keys()方法会返回一个由一个给定对象的自身可枚举属性组成的数组，数组中属性名的排列顺序和使用 for...in 循环遍历该对象时返回的顺序一致 （两者的主要区别是 一个 for-in 循环还会枚举其原型链上的属性）。\nvar value = initialValue[key];\nthis.cache(key, value);\n}\n}")]),n._v(" "),t("p",[n._v("var p = Cache.prototype")]),n._v(" "),t("p",[n._v("p.isEmpty = function () {\nreturn this.head == null && this.tail == null;\n};")]),n._v(" "),t("p",[n._v("//在头部做添加\np.addFirst = function (obj) {\nvar newNode = new Node(obj, null);\nif (this.isEmpty()) {\nthis.head = this.tail = newNode;\n} else {\nthis.head.next = newNode;\nthis.head = newNode;\n//链表是反着的，head 是最后一个节点\n}\nthis.size++;\nnewNode = null;\n};")]),n._v(" "),t("p",[n._v("//在尾部做删除\np.removeLast = function () {\nif (!this.isEmpty()) {\nvar key = Object.keys(this.tail.value)[0];\ndelete this[key];\nthis.tail = this.tail.next;\nif (this.tail == null) {\nthis.head = null;\n}\nthis.size--;\n}\n};")]),n._v(" "),t("p",[n._v("//将节点向头部移动\np.moveForward = function (key) {\nvar node = this.search(key);\nif (node && node.next) {\nvar next = node.next;\nvar temp = node.value;\nnode.value = next.value;\nnext.value = temp;\n//位置交换了一下\n}\n};")]),n._v(" "),t("p",[n._v("//缓存元素\np.cache = function (key, value) {\n//先查找是否已存在\nvar result = this.search(key);\n//已存在采取覆盖 value 策略\nif (result) {\nresult.value[key] = value;\nthis[key] = value;\n} else {\nvar obj = {};\nobj[key] = value;\nthis.addFirst(obj);\nvar that = this;\nObject.defineProperty(this, key, {\nset: function (x) {\nthat.moveForward(key);\nvalue = x;\n},\nget: function () {\nthat.moveForward(key); return value;\n},\nconfigurable: true,\nenumerable: true\n});\n//超出容量的话，将最少使用的删除\nif (this.size > this.capacity) {\nthis.removeLast();\n}\n}\n//可以链式调用\nreturn this;\n};")]),n._v(" "),t("p",[n._v("//删除元素\np.del = function (key) {\nif (this.search(key)) {\nvar previous = null;\nvar cur = this.tail;\nfor (; cur; cur = cur.next) {\nif (cur.value.hasOwnProperty(key)) {\nbreak;\n}\nprevious = cur;\n}\nif (previous) {\nif (previous.next) {\n//待定，感觉有点问题，删除的是目标值的后一个节点\nprevious.next = previous.next.next;\nthis.size--;\n}\n} else {\nthis.tail = this.tail.next;\nthis.size--;\n}\n}\nif (this.hasOwnProperty(key)) {\nreturn (delete this[key]);\n} else {\nreturn (delete p.prototype[key]);\n}\n};")]),n._v(" "),t("p",[n._v("//查找元素\np.search = function (key) {\nfor (var e = this.tail; e; e = e.next) {\nif (key in e.value) {\nconsole.log(key + ' 命中缓存！')\nreturn e;\n}\n}\nreturn null;\n};")]),n._v(" "),t("p",[n._v("function sleep(milliseconds) {\nvar start = new Date().getTime();\nfor (var i = 0; i < 1e7; i++) { if ((new Date().getTime() - start)> milliseconds) {\nbreak;\n}\n}\n}")]),n._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[n._v("var cache = new Cache(2)\n\nfunction parseText(text, value) {\nreturn p.cache(text, value)\n}\n\nfunction formatTokens(tokens, scope) {\nreturn tokens.map(function (token) {\nif (token.tag) {\nreturn scope[token.value]\n}\nreturn token.value\n}).join('')\n}\n(function init() {\nvar muds = [\n"+n._s(n.card_name)+"在某某大师的指导下， 开始学习铁砂掌,\n"+n._s(n.card_name)+"很认真的学习，铁砂掌技能熟练度增加了！,\n"+n._s(n.card_name)+"的好朋友小明说：天气不错。我们去踢足球吧。,\n"+n._s(n.card_name)+"说：小红你去玩吧，我要学习铁砂掌,\n"+n._s(n.card_name)+"很认真的学习，铁砂掌技能熟练度增加了！,\n"+n._s(n.card_name)+"的同学小华说：晚上我们去吃火锅吧。,\n"+n._s(n.card_name)+"说：小华你去吃吧，我要学习铁砂掌,\n"+n._s(n.card_name)+"很认真的学习，铁砂掌技能熟练度增加了！,\n"+n._s(n.card_name)+"天资聪慧，在学习期间认真听讲，闭着眼睛通过了考试\n]\n\nvar start = (new Date()).getTime()\nvar scope = {\ncard_name: 'XX'\n}\nvar text = muds.map(function (mud) {\nreturn parseText(mud, scope)\n}).join('\\n')\nvar end = (new Date()).getTime()\nconsole.log(end - start)\n\ndocument.getElementById('result').innerText = muds\n})()`\n\ndocument.getElementById('result').innerHTML = text\n")])])])])}),[],!1,null,null,null);e.default=i.exports}}]);